

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Reading modis level1b data &#8212; ATSC 301</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/week1/modis_level1b_read';</script>
    <link rel="canonical" href="https://hub.eoastest.xyz/a301/notebooks/week1/modis_level1b_read.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Week 2" href="../week2/week2_topics.html" />
    <link rel="prev" title="Acquiring satellite data" href="satellite.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    <p class="title logo__title">ATSC 301</p>
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    ATSC 301: Term 2 2022
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 1</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="week1_topics.html">Week 1</a></li>
<li class="toctree-l1"><a class="reference internal" href="a301_syllabus.html">ATSC 301: syllabus</a></li>
<li class="toctree-l1"><a class="reference internal" href="e582_syllabus.html">ATSC 301: syllabus</a></li>
<li class="toctree-l1"><a class="reference internal" href="integrity.html">UBC academic integrity</a></li>
<li class="toctree-l1"><a class="reference internal" href="texts.html">Texts</a></li>
<li class="toctree-l1"><a class="reference internal" href="satellite.html">Acquiring satellite data</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Reading modis level1b data</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 2</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../week2/week2_topics.html">Week 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../week2/beers_law.html">Beers and inverse squared laws</a></li>
<li class="toctree-l1"><a class="reference internal" href="../week2/sensors.html">Solid angle and radiance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../week2/flux_from_radiance.html">Finding the flux given the radiance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../week2/planck_function.html">Integrating the Planck function with python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../week2/debugging_intro.html">how to debug</a></li>
<li class="toctree-l1"><a class="reference internal" href="../week2/derivs_and_ints.html">working with numpy arrays</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 3</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../week3/week3_topics.html">Week 3</a></li>
<li class="toctree-l1"><a class="reference internal" href="../week3/files_and_paths.html">Course folders on a301hub and your laptop</a></li>
<li class="toctree-l1"><a class="reference internal" href="../week3/modis_geom_read.html">Reading modis level1b data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../week3/radiance_values.html">Sanity checking radiance vaules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../week3/mapping.html">Geographic coordinate systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../week3/cartopy_maps.html">Introduction to Cartopy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../week3/cartopy_mapping_vancouver.html">Mapping Vancouver with cartopy</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 4</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../week4/week4_topics.html">Week 4</a></li>
<li class="toctree-l1"><a class="reference internal" href="../week4/using_libraries.html">Working with libraries</a></li>
<li class="toctree-l1"><a class="reference internal" href="../week4/schwartz.html">The Schwartzchild Equation</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 5</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../week5/week5_topics.html">Week 5</a></li>
<li class="toctree-l1"><a class="reference internal" href="../week5/cartopy_resample_ch30.html">Use pyresample and cartopy to plot channel 30 radiances</a></li>
<li class="toctree-l1"><a class="reference internal" href="../week5/wv_resample.html">Resampling the water vapor</a></li>
<li class="toctree-l1"><a class="reference internal" href="../week5/longwave_resample.html">Resampling channel 31</a></li>
<li class="toctree-l1"><a class="reference internal" href="../week5/hydrostat.html">Hydrostatic balance</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 6</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../week6/week6_topics.html">Week 6</a></li>
<li class="toctree-l1"><a class="reference internal" href="../week6/pandas_intro.html">Introduction to Pandas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../week6/pandas-cheatsheet.html">Pandas Cheatsheet</a></li>
<li class="toctree-l1"><a class="reference internal" href="../week6/hydrostatic_balance.html">Scale heights for typical atmospheric soundings</a></li>
<li class="toctree-l1"><a class="reference internal" href="../week6/weighting_functions.html">Weighting functions for temperature retrieval</a></li>
<li class="toctree-l1"><a class="reference internal" href="../week6/writing_geotiffs.html">Writing the 5km water vapor image to a geotiff file</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 7</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../week7/week7_topics.html">Week 7</a></li>
<li class="toctree-l1"><a class="reference internal" href="../week7/writing_geotiffs_with_rioxarray.html">Using xarray to work with geotiffs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../week7/get_landsat_bands.html">Dowloading Landsat and Sentinel data from NASA</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 8</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../week8/week8_topics.html">Week 8</a></li>
<li class="toctree-l1"><a class="reference internal" href="../week8/fetch_stac_metadata.html">Getting multiple scenes using stac</a></li>
<li class="toctree-l1"><a class="reference internal" href="../week8/zoom_landsat.html">Clipping and saving landsat scenes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../week8/windowed_read.html">Reading landsat data with a rasterio window</a></li>
<li class="toctree-l1"><a class="reference internal" href="../week8/test_landsat_read.html">simple test of <code class="docutils literal notranslate"><span class="pre">get_landsat_scene</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../week8/pandas_week8_worksheet.html">Week8 worksheet – using pandas</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 9</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../week9/week9_topics.html">Week 9</a></li>
<li class="toctree-l1"><a class="reference internal" href="../week9/xarray_datasets.html">xarray datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../week9/radar.html">Notes on the radar equation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../week9/marshall_palmer.html">Notes on the Marshall-Palmer distribution and the Z-RR relation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../week9/readcloudsat.html">Reading cloudsat data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../week9/test_landsat_dataset.html">Adding data to an image with xarray datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../week9/cloudsat_ecmwf.html">Working with cloudsat data</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 10</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../week10/week10_topics.html">Week 10</a></li>
<li class="toctree-l1"><a class="reference internal" href="../week10/temperature_perturb.html">Cloudsat: Plotting ECMWF temperature and wind speed</a></li>
<li class="toctree-l1"><a class="reference internal" href="../week10/write_geotiffs.html">Landsat: Writing the scenes for each season to netcdf files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../week10/rainrate.html">Cloudsat: liquid and ice precipitation and rain rate</a></li>
<li class="toctree-l1"><a class="reference internal" href="../week10/false_color.html">Making color composite (“false color”) images</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 11</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../week11/week11_topics.html">Week 11</a></li>
<li class="toctree-l1"><a class="reference internal" href="../week11/cloudsat_flxhr.html">Cloudsat heating rate</a></li>
<li class="toctree-l1"><a class="reference internal" href="../week11/flux_from_radiance_rev.html">Flux and radiance review</a></li>
<li class="toctree-l1"><a class="reference internal" href="../week11/flux_schwartzchild.html">The Schwartzchild equation for flux</a></li>
<li class="toctree-l1"><a class="reference internal" href="../week11/diffuse_flux.html">Calculating the diffuse flux</a></li>
<li class="toctree-l1"><a class="reference internal" href="../week11/heating_rate.html">Finding the heating rate of the atmosphere</a></li>
<li class="toctree-l1"><a class="reference internal" href="../week11/false_examples.html">Landsat 8 false color examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../week11/goes_true_color.html">GOES-16: True Color Images from GOES ABI</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 12</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../week12/week12_topics.html">Week 12</a></li>
<li class="toctree-l1"><a class="reference internal" href="../week12/goes_michael.html">GIS image processing review</a></li>
<li class="toctree-l1"><a class="reference internal" href="../week12/final_guide.html">Study guide for final exam –</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Assignments</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../assignments/assign1_handin_solution.html">Assignment 1 solution– brightness temperatures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../assignments/assign2a_solution.html">Assignment 2a - solutions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../assignments/assign2b_solution.html">Assignment 2b solutions: Drawing your satellite swath</a></li>
<li class="toctree-l1"><a class="reference internal" href="../assignments/assignment3a_solution.html">Assignment 3a – Solution</a></li>
<li class="toctree-l1"><a class="reference internal" href="../assignments/assignment3b_solution.html">Assignment 3b – Solution</a></li>
<li class="toctree-l1"><a class="reference internal" href="../assignments/assignment4_solution.html">Assignment 4 – solutions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../assignments/assign5_handin.html">Assignment 5 Handin</a></li>
<li class="toctree-l1"><a class="reference internal" href="../assignments/assignment5_solution.html">Assignment 5 Landsat + Marshall Palmer: Solution</a></li>

<li class="toctree-l1"><a class="reference internal" href="../assignments/assign6_handin.html">Assignment 6: Hurricane case study, Due Thursday, April 13 11:59pm</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Midterm</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../midterm/a301_mid_2022t2_solutions.html">A301 midterm – solutions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../midterm/mid_term_reviewI.html">Sample mid-term questions I</a></li>
<li class="toctree-l1"><a class="reference internal" href="../midterm/mid_term_reviewII.html">Midterm review questions II</a></li>
<li class="toctree-l1"><a class="reference internal" href="../midterm/mid_term_reviewI_solutions.html">Solutions: sample questions I</a></li>
<li class="toctree-l1"><a class="reference internal" href="../midterm/mid_term_reviewII_solutions.html">Solutions: sample questions II</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">References</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../assignments.html">Assignments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks.html">List of notebooks</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://jupyter.eoastest.xyz/hub/user-redirect/git-pull?repo=https%3A//github.com/phaustin/a301_2020&urlpath=tree/a301_2020/./notebooks/week1/modis_level1b_read.ipynb&branch=master" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onJupyterHub"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../../_static/images/logo_jupyterhub.svg">
  </span>
<span class="btn__text-container">JupyterHub</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/notebooks/week1/modis_level1b_read.ipynb" target="_blank"
   class="btn btn-sm btn-download-notebook-button dropdown-item"
   title="Download notebook file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-code"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li><a href="../../_sources/notebooks/week1/modis_level1b_read.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Reading modis level1b data</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#background">Background</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#get-all-files-from-the-data-dir-that-end-in-hdf">get all files from the data_dir that end in hdf</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#find-the-dataset-and-print-their-indices">Find the dataset and print their indices</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#open-one-of-the-datasets-number-4-ev-1km-emissive-and-get-its-shape-and-data-type">open one of the datasets (number 4, EV_1KM_Emissive) and get its shape and data type</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#get-the-first-row-of-the-first-channel-and-find-its-numpy-dtype">Get the first row of the first channel and find its numpy dtype</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#get-all-the-rows-and-columns-for-the-first-channel">get all the rows and columns for the first channel</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#find-the-attributes-for-ev-1km-emissive">Find the attributes for EV_1KM_Emissive</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#print-the-first-1000-characters-of-the-metadata-0-string">Print the first 1000 characters of the Metadata.0 string</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#now-plot-the-data-using-imshow">Now plot the data using imshow</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#find-the-index-for-channel-30">find the index for channel 30</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#now-get-the-data-for-channel-30">Now get the data for channel 30</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#now-convert-the-raw-counts-to-radiances">Now convert the raw counts to radiances</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-the-channel-30-radiances">Plot the Channel 30 radiances</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#write-the-radiances-out-for-safekeeping">Write the radiances out for safekeeping</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#move-all-of-this-into-a-function">move all of this into a function</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#close-the-file">close the file</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="reading-modis-level1b-data">
<span id="modis-level1b"></span><h1>Reading modis level1b data<a class="headerlink" href="#reading-modis-level1b-data" title="Permalink to this heading">#</a></h1>
<section id="background">
<h2>Background<a class="headerlink" href="#background" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://mcst.gsfc.nasa.gov/l1b/software-system-overview">https://mcst.gsfc.nasa.gov/l1b/software-system-overview</a></p></li>
<li><p><a class="reference external" href="https://modis.gsfc.nasa.gov/about/specifications.php">https://modis.gsfc.nasa.gov/about/specifications.php</a></p></li>
<li><p><a class="reference external" href="https://www.earthdatascience.org/courses/use-data-open-source-python/hierarchical-data-formats-hdf/intro-to-hdf4/">hdf4</a></p></li>
<li><p><a class="reference external" href="https://svs.gsfc.nasa.gov/3348">modis swath info</a></p></li>
<li><p><a class="reference external" href="https://modis.gsfc.nasa.gov/about/specifications.php">modis channel listing</a></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pprint</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>

<span class="kn">import</span> <span class="nn">a301_lib</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">from</span> <span class="nn">pyhdf.SD</span> <span class="kn">import</span> <span class="n">SD</span>
<span class="kn">from</span> <span class="nn">pyhdf.SD</span> <span class="kn">import</span> <span class="n">SDC</span>
<span class="kn">from</span> <span class="nn">matplotlib.colors</span> <span class="kn">import</span> <span class="n">Normalize</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>in a301_lib init
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">a301_lib</span><span class="o">.</span><span class="n">sat_data</span><span class="p">)</span>
<span class="nb">type</span><span class="p">(</span><span class="n">a301_lib</span><span class="o">.</span><span class="n">sat_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/phil/sat_data
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>pathlib.PosixPath
</pre></div>
</div>
</div>
</div>
</section>
<section id="get-all-files-from-the-data-dir-that-end-in-hdf">
<h2>get all files from the data_dir that end in hdf<a class="headerlink" href="#get-all-files-from-the-data-dir-that-end-in-hdf" title="Permalink to this heading">#</a></h2>
<p>a301_lib.sat_data is a <code class="docutils literal notranslate"><span class="pre">PosixPath</span></code> object, which is the way that python is able to treat all folder paths the same, whether they look like <code class="docutils literal notranslate"><span class="pre">C:\Users\phil</span></code> or <code class="docutils literal notranslate"><span class="pre">/Users/home/phil</span></code></p>
<p>My satellite granule date and time is 2013222.2150 so the cell below returns a list of length 1 that includes that file in folder <code class="docutils literal notranslate"><span class="pre">pha</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hdf4_dir</span> <span class="o">=</span> <span class="n">a301_lib</span><span class="o">.</span><span class="n">sat_data</span> <span class="o">/</span> <span class="s2">&quot;pha&quot;</span>
<span class="n">all_files</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">hdf4_dir</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">&quot;MYD021KM*2013222*hdf&quot;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">all_files</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[PosixPath(&#39;/home/phil/sat_data/pha/MYD021KM.A2013222.2105.061.2018047235850.hdf&#39;)]
</pre></div>
</div>
</div>
</div>
<p>Now read that file (converting PosixPath into a string since the pyhdf library is
expecting a string).  Use the <code class="docutils literal notranslate"><span class="pre">.info</span></code> method to get the number of datasets and attributes</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">file_name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">all_files</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;reading </span><span class="si">{</span><span class="n">file_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">the_file</span> <span class="o">=</span> <span class="n">SD</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="n">SDC</span><span class="o">.</span><span class="n">READ</span><span class="p">)</span>
<span class="n">stars</span> <span class="o">=</span> <span class="s2">&quot;*&quot;</span> <span class="o">*</span> <span class="mi">50</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">stars</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="sa">f</span><span class="s2">&quot;number of datasets, number of attributes</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="sa">f</span><span class="s2">&quot;=</span><span class="si">{</span><span class="n">the_file</span><span class="o">.</span><span class="n">info</span><span class="p">()</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">stars</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Here is the help file for the info funtion:</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="p">)</span>
<span class="p">)</span>
<span class="c1">#help(SD.info)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>reading /home/phil/sat_data/pha/MYD021KM.A2013222.2105.061.2018047235850.hdf

**************************************************
number of datasets, number of attributes
=(31, 58)
**************************************************

Here is the help file for the info funtion:
</pre></div>
</div>
</div>
</div>
</section>
<section id="find-the-dataset-and-print-their-indices">
<h2>Find the dataset and print their indices<a class="headerlink" href="#find-the-dataset-and-print-their-indices" title="Permalink to this heading">#</a></h2>
<p>We know we’ve got 31 datasets in the file – what are their names?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datasets_dict</span> <span class="o">=</span> <span class="n">the_file</span><span class="o">.</span><span class="n">datasets</span><span class="p">()</span>

<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">sds</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">datasets_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">sds</span><span class="p">)</span>

<span class="c1">#breakpoint()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0 Latitude
1 Longitude
2 EV_1KM_RefSB
3 EV_1KM_RefSB_Uncert_Indexes
4 EV_1KM_Emissive
5 EV_1KM_Emissive_Uncert_Indexes
6 EV_250_Aggr1km_RefSB
7 EV_250_Aggr1km_RefSB_Uncert_Indexes
8 EV_250_Aggr1km_RefSB_Samples_Used
9 EV_500_Aggr1km_RefSB
10 EV_500_Aggr1km_RefSB_Uncert_Indexes
11 EV_500_Aggr1km_RefSB_Samples_Used
12 Height
13 SensorZenith
14 SensorAzimuth
15 Range
16 SolarZenith
17 SolarAzimuth
18 gflags
19 EV_Band26
20 EV_Band26_Uncert_Indexes
21 Band_250M
22 Band_500M
23 Band_1KM_RefSB
24 Band_1KM_Emissive
25 Noise in Thermal Detectors
26 Change in relative responses of thermal detectors
27 DC Restore Change for Thermal Bands
28 DC Restore Change for Reflective 250m Bands
29 DC Restore Change for Reflective 500m Bands
30 DC Restore Change for Reflective 1km Bands
</pre></div>
</div>
</div>
</div>
</section>
<section id="open-one-of-the-datasets-number-4-ev-1km-emissive-and-get-its-shape-and-data-type">
<h2>open one of the datasets (number 4, EV_1KM_Emissive) and get its shape and data type<a class="headerlink" href="#open-one-of-the-datasets-number-4-ev-1km-emissive-and-get-its-shape-and-data-type" title="Permalink to this heading">#</a></h2>
<p>The “Earth View Emissive” dataset contains all the longwave channels, and all the 2030 rows and 1354 columns for each
pixel in each channel</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">longwave_data</span> <span class="o">=</span> <span class="n">the_file</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;EV_1KM_Emissive&quot;</span><span class="p">)</span>  <span class="c1"># select sds</span>
<span class="nb">print</span><span class="p">(</span><span class="n">longwave_data</span><span class="o">.</span><span class="n">info</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&#39;EV_1KM_Emissive&#39;, 3, [16, 2040, 1354], 23, 8)
</pre></div>
</div>
</div>
</div>
</section>
<section id="get-the-first-row-of-the-first-channel-and-find-its-numpy-dtype">
<h2>Get the first row of the first channel and find its numpy dtype<a class="headerlink" href="#get-the-first-row-of-the-first-channel-and-find-its-numpy-dtype" title="Permalink to this heading">#</a></h2>
<p>uint16 is “unsigned 16 bit integer”, which is how the modis raw counts are stored.  By using
2 8-bit words (2 bytes) for each measurement they can represent (2**16)-1 = 65535 radiance values.  This means, however that every measurement has to be converted from uin16 to float32 before it
can be used</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_row</span> <span class="o">=</span> <span class="n">longwave_data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:]</span>  <span class="c1"># get sds data</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data_row</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">data_row</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(1354,) uint16
</pre></div>
</div>
</div>
</div>
</section>
<section id="get-all-the-rows-and-columns-for-the-first-channel">
<h2>get all the rows and columns for the first channel<a class="headerlink" href="#get-all-the-rows-and-columns-for-the-first-channel" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">longwave_data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[4799, 4471, 5255, ..., 7359, 7389, 7562],
       [5119, 4523, 5478, ..., 7736, 7781, 7811],
       [5152, 4442, 5809, ..., 7831, 7629, 7674],
       ...,
       [7965, 8175, 8227, ..., 7914, 7413, 7600],
       [7943, 7801, 7831, ..., 7539, 7404, 7223],
       [7926, 7955, 7799, ..., 7209, 7344, 6985]], dtype=uint16)
</pre></div>
</div>
</div>
</div>
</section>
<section id="find-the-attributes-for-ev-1km-emissive">
<h2>Find the attributes for EV_1KM_Emissive<a class="headerlink" href="#find-the-attributes-for-ev-1km-emissive" title="Permalink to this heading">#</a></h2>
<p>In order to make the conversion from int to float, we need to
multiply by a scale factor and subtract an offset.  These are
stored as attributes in the hdf file, and they are different
for each of the 16 channels.  Use <code class="docutils literal notranslate"><span class="pre">pprint</span></code> to pretty-print the big
dictionary.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">longwave_data</span><span class="o">.</span><span class="n">attributes</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;_FillValue&#39;: 65535,
 &#39;band_names&#39;: &#39;20,21,22,23,24,25,27,28,29,30,31,32,33,34,35,36&#39;,
 &#39;long_name&#39;: &#39;Earth View 1KM Emissive Bands Scaled Integers&#39;,
 &#39;radiance_offsets&#39;: [2467.264404296875,
                      2480.6005859375,
                      2478.176513671875,
                      2402.468505859375,
                      1077.44482421875,
                      1560.3333740234375,
                      2724.21826171875,
                      2317.48828125,
                      2610.015380859375,
                      1560.333251953125,
                      2035.9332275390625,
                      2119.08447265625,
                      2500.599365234375,
                      2499.093505859375,
                      2500.5205078125,
                      2495.89111328125],
 &#39;radiance_scales&#39;: [6.9307534431573e-05,
                     0.00346690253354609,
                     7.626575097674504e-05,
                     8.990753121906891e-05,
                     3.155614103889093e-05,
                     5.639820665237494e-05,
                     0.00011783196532633156,
                     0.0001924497337313369,
                     0.0005570848588831723,
                     0.0004063234373461455,
                     0.0006508072256110609,
                     0.0005710012628696859,
                     0.0002623370965011418,
                     0.00020087281882297248,
                     0.00017676320567261428,
                     0.00011859492224175483],
 &#39;radiance_units&#39;: &#39;Watts/m^2/micrometer/steradian&#39;,
 &#39;units&#39;: &#39;none&#39;,
 &#39;valid_range&#39;: [0, 32767]}
</pre></div>
</div>
</div>
</div>
</section>
<section id="print-the-first-1000-characters-of-the-metadata-0-string">
<h2>Print the first 1000 characters of the Metadata.0 string<a class="headerlink" href="#print-the-first-1000-characters-of-the-metadata-0-string" title="Permalink to this heading">#</a></h2>
<p>Date, orbit number, etc. are stored in a long string attribute called ‘StructMetadata.0’.
The \t character is a tab stop so the file is easier to read with an editor.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">the_file</span><span class="o">.</span><span class="n">attributes</span><span class="p">()[</span><span class="s2">&quot;StructMetadata.0&quot;</span><span class="p">][:</span><span class="mi">1000</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&#39;GROUP=SwathStructure\n&#39;
 &#39;\tGROUP=SWATH_1\n&#39;
 &#39;\t\tSwathName=&quot;MODIS_SWATH_Type_L1B&quot;\n&#39;
 &#39;\t\tGROUP=Dimension\n&#39;
 &#39;\t\t\tOBJECT=Dimension_1\n&#39;
 &#39;\t\t\t\tDimensionName=&quot;Band_250M&quot;\n&#39;
 &#39;\t\t\t\tSize=2\n&#39;
 &#39;\t\t\tEND_OBJECT=Dimension_1\n&#39;
 &#39;\t\t\tOBJECT=Dimension_2\n&#39;
 &#39;\t\t\t\tDimensionName=&quot;Band_500M&quot;\n&#39;
 &#39;\t\t\t\tSize=5\n&#39;
 &#39;\t\t\tEND_OBJECT=Dimension_2\n&#39;
 &#39;\t\t\tOBJECT=Dimension_3\n&#39;
 &#39;\t\t\t\tDimensionName=&quot;Band_1KM_RefSB&quot;\n&#39;
 &#39;\t\t\t\tSize=15\n&#39;
 &#39;\t\t\tEND_OBJECT=Dimension_3\n&#39;
 &#39;\t\t\tOBJECT=Dimension_4\n&#39;
 &#39;\t\t\t\tDimensionName=&quot;Band_1KM_Emissive&quot;\n&#39;
 &#39;\t\t\t\tSize=16\n&#39;
 &#39;\t\t\tEND_OBJECT=Dimension_4\n&#39;
 &#39;\t\t\tOBJECT=Dimension_5\n&#39;
 &#39;\t\t\t\tDimensionName=&quot;10*nscans&quot;\n&#39;
 &#39;\t\t\t\tSize=2040\n&#39;
 &#39;\t\t\tEND_OBJECT=Dimension_5\n&#39;
 &#39;\t\t\tOBJECT=Dimension_6\n&#39;
 &#39;\t\t\t\tDimensionName=&quot;Max_EV_frames&quot;\n&#39;
 &#39;\t\t\t\tSize=1354\n&#39;
 &#39;\t\t\tEND_OBJECT=Dimension_6\n&#39;
 &#39;\t\t\tOBJECT=Dimension_7\n&#39;
 &#39;\t\t\t\tDimensionName=&quot;2*nscans&quot;\n&#39;
 &#39;\t\t\t\tSize=408\n&#39;
 &#39;\t\t\tEND_OBJECT=Dimension_7\n&#39;
 &#39;\t\t\tOBJECT=Dimension_8\n&#39;
 &#39;\t\t\t\tDimensionName=&quot;1KM_geo_dim&quot;\n&#39;
 &#39;\t\t\t\tSize=271\n&#39;
 &#39;\t\t\tEND_OBJECT=Dimension_8\n&#39;
 &#39;\t\tEND_GROUP=Dimension\n&#39;
 &#39;\t\tGROUP=DimensionMap\n&#39;
 &#39;\t\t\tOBJECT=DimensionMap_1\n&#39;
 &#39;\t\t\t\tGeoDimension=&quot;2*nscans&quot;\n&#39;
 &#39;\t\t\t\tDataDimension=&quot;10*nscans&quot;\n&#39;
 &#39;\t\t\t\tOffset=2\n&#39;
 &#39;\t\t\t\tIncrement=5\n&#39;
 &#39;\t\t\tEND_OBJECT=&#39;)
</pre></div>
</div>
</div>
</div>
</section>
<section id="now-plot-the-data-using-imshow">
<h2>Now plot the data using imshow<a class="headerlink" href="#now-plot-the-data-using-imshow" title="Permalink to this heading">#</a></h2>
<p>Start over again and make a plot.  We need to be
able to identify particular bands  – the channel numbers
are stored in the “Band_1KM_Emissive” dataset</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">longwave_bands</span> <span class="o">=</span> <span class="n">the_file</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;Band_1KM_Emissive&quot;</span><span class="p">)</span>
<span class="c1">#</span>
<span class="c1"># close the file</span>
<span class="c1">#</span>
<span class="n">longwave_bands</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&#39;Band_1KM_Emissive&#39;, 1, 16, 5, 1)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">band_nums</span> <span class="o">=</span> <span class="n">longwave_bands</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;here are the modis channels in the emissive dataset </span><span class="se">\n</span><span class="si">{</span><span class="n">band_nums</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>here are the modis channels in the emissive dataset 
[20. 21. 22. 23. 24. 25. 27. 28. 29. 30. 31. 32. 33. 34. 35. 36.]
</pre></div>
</div>
</div>
</div>
<p>Note that only channels 20 to 36 are in the Emissive dataset (see <a class="reference external" href="https://modis.gsfc.nasa.gov/about/specifications.php">the Modis channel listing</a>)</p>
<p>Note that only channels 20 to 36 are in the Emissive dataset (see <a class="reference external" href="https://modis.gsfc.nasa.gov/about/specifications.php">the Modis channel listing</a>)</p>
</section>
<section id="find-the-index-for-channel-30">
<h2>find the index for channel 30<a class="headerlink" href="#find-the-index-for-channel-30" title="Permalink to this heading">#</a></h2>
<p>Count the items in the vector above and convince yourself that channel 30 is index 9, starting from 0</p>
<p>But there’s a better way: use numpy.searchsorted to find the index with the closest value
to 30:</p>
<p>We also need to turn that index (type int64) into a plain python int so it can be used to specify the channel</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ch30_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">searchsorted</span><span class="p">(</span><span class="n">band_nums</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;make sure our index datatime in int64: </span><span class="si">{</span><span class="n">ch30_index</span><span class="o">.</span><span class="n">dtype</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">ch30_index</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">ch30_index</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;channel 30 is located at index </span><span class="si">{</span><span class="n">ch30_index</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>


<span class="c1"># ## Read channel 30 at index 9 into a numpy array of type uint16</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>make sure our index datatime in int64: int64
channel 30 is located at index 9
</pre></div>
</div>
</div>
</div>
</section>
<section id="now-get-the-data-for-channel-30">
<span id="modis-chan30"></span><h2>Now get the data for channel 30<a class="headerlink" href="#now-get-the-data-for-channel-30" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ch30_data</span> <span class="o">=</span> <span class="n">longwave_data</span><span class="p">[</span><span class="n">ch30_index</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ch30_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ch30_data</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
<span class="c1">#breakpoint()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(2040, 1354)
uint16
</pre></div>
</div>
</div>
</div>
<p>Plot the channel 30 image</p>
<p>Use <a class="reference external" href="https://matplotlib.org/gallery/color/colorbar_basics.html#sphx-glr-gallery-color-colorbar-basics-py">imshow with a colorbar</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">14</span><span class="p">))</span>
<span class="n">CS</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ch30_data</span><span class="p">)</span>
<span class="n">cax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">CS</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;uncalibrated counts&quot;</span><span class="p">)</span>
<span class="c1">#</span>
<span class="c1"># add a label to the colorbar and flip it around 270 degrees</span>
<span class="c1"># (just my personal preference for labels)</span>
<span class="c1">#</span>
<span class="n">out</span> <span class="o">=</span> <span class="n">cax</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Chan 30 raw counts&quot;</span><span class="p">)</span>
<span class="n">out</span><span class="o">.</span><span class="n">set_verticalalignment</span><span class="p">(</span><span class="s2">&quot;bottom&quot;</span><span class="p">)</span>
<span class="n">out</span><span class="o">.</span><span class="n">set_rotation</span><span class="p">(</span><span class="mi">270</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ch30_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(2040, 1354)
</pre></div>
</div>
<img alt="../../_images/0104213607694933802f79b6b6063c162a139d603e3a711f24198741bc916757.png" src="../../_images/0104213607694933802f79b6b6063c162a139d603e3a711f24198741bc916757.png" />
</div>
</div>
</section>
<section id="now-convert-the-raw-counts-to-radiances">
<h2>Now convert the raw counts to radiances<a class="headerlink" href="#now-convert-the-raw-counts-to-radiances" title="Permalink to this heading">#</a></h2>
<p>We need to find the right scale and offset for channel 30</p>
<p>To turn the raw counts into pixel radiances, you need to apply equation 5.8 on p. 36 of the
<a class="reference external" href="https://www.dropbox.com/s/ckd3dv4n7nxc9p0/modis_users_guide.pdf?dl=0">modis users guide</a>:</p>
<p><span class="math notranslate nohighlight">\(Radiances = (RawData - offset) \times scale\)</span></p>
<p>We have just read the RawData,  the offset and the scale are stored in two vectors that are attributes of the Emissive dataset.  We’ll make a version of the figure above, but plot Channel 30 radiance (in W/m^2/micron/sr), rather than raw counts.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">scales</span> <span class="o">=</span> <span class="n">longwave_data</span><span class="o">.</span><span class="n">attributes</span><span class="p">()[</span><span class="s2">&quot;radiance_scales&quot;</span><span class="p">]</span>
<span class="n">offsets</span> <span class="o">=</span> <span class="n">longwave_data</span><span class="o">.</span><span class="n">attributes</span><span class="p">()[</span><span class="s2">&quot;radiance_offsets&quot;</span><span class="p">]</span>
<span class="n">ch30_scale</span> <span class="o">=</span> <span class="n">scales</span><span class="p">[</span><span class="n">ch30_index</span><span class="p">]</span>
<span class="n">ch30_offset</span> <span class="o">=</span> <span class="n">offsets</span><span class="p">[</span><span class="n">ch30_index</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;scale: </span><span class="si">{</span><span class="n">ch30_scale</span><span class="si">}</span><span class="s2">, offset: </span><span class="si">{</span><span class="n">ch30_offset</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>scale: 0.0004063234373461455, offset: 1560.333251953125
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ch30_calibrated</span> <span class="o">=</span> <span class="p">(</span><span class="n">ch30_data</span> <span class="o">-</span> <span class="n">ch30_offset</span><span class="p">)</span> <span class="o">*</span> <span class="n">ch30_scale</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="plot-the-channel-30-radiances">
<span id="modis-level1b-plot"></span><h2>Plot the Channel 30 radiances<a class="headerlink" href="#plot-the-channel-30-radiances" title="Permalink to this heading">#</a></h2>
<p>Do these look right?  How would you tell?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">14</span><span class="p">))</span>
<span class="n">vmin</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">vmax</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">the_norm</span> <span class="o">=</span> <span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span> <span class="n">clip</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">CS</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ch30_calibrated</span><span class="p">,</span><span class="n">norm</span><span class="o">=</span><span class="n">the_norm</span><span class="p">)</span>
<span class="n">cax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">CS</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Channel 30 radiance&quot;</span><span class="p">)</span>
<span class="c1">#</span>
<span class="c1"># add a label to the colorbar and flip it around 270 degrees</span>
<span class="c1">#</span>
<span class="n">out</span> <span class="o">=</span> <span class="n">cax</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Chan radiance $(W\,m^{-2}\,\mu m^{-1}\,sr^{-1})$&quot;</span><span class="p">)</span>
<span class="n">out</span><span class="o">.</span><span class="n">set_verticalalignment</span><span class="p">(</span><span class="s2">&quot;bottom&quot;</span><span class="p">)</span>
<span class="n">out</span><span class="o">.</span><span class="n">set_rotation</span><span class="p">(</span><span class="mi">270</span><span class="p">)</span>
<span class="n">ch30_calibrated</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(2040, 1354)
</pre></div>
</div>
<img alt="../../_images/da19db5702e839297c664d2a2c0e2c53a9c306efae07d3b57fdcb4bfce2f4308.png" src="../../_images/da19db5702e839297c664d2a2c0e2c53a9c306efae07d3b57fdcb4bfce2f4308.png" />
</div>
</div>
</section>
<section id="write-the-radiances-out-for-safekeeping">
<h2>Write the radiances out for safekeeping<a class="headerlink" href="#write-the-radiances-out-for-safekeeping" title="Permalink to this heading">#</a></h2>
<p>Follow the example here: https://hdfeos.org/software/pyhdf.php</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create an HDF file</span>
<span class="n">outname</span> <span class="o">=</span> <span class="s2">&quot;ch30_out.hdf&quot;</span>
<span class="n">sd</span> <span class="o">=</span> <span class="n">SD</span><span class="p">(</span><span class="n">outname</span><span class="p">,</span> <span class="n">SDC</span><span class="o">.</span><span class="n">CREATE</span> <span class="o">|</span> <span class="n">SDC</span><span class="o">.</span><span class="n">WRITE</span> <span class="o">|</span> <span class="n">SDC</span><span class="o">.</span><span class="n">TRUNC</span><span class="p">)</span>

<span class="c1"># Create a dataset</span>
<span class="n">sds</span> <span class="o">=</span> <span class="n">sd</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="s2">&quot;ch30&quot;</span><span class="p">,</span> <span class="n">SDC</span><span class="o">.</span><span class="n">FLOAT64</span><span class="p">,</span> <span class="n">ch30_calibrated</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

<span class="c1"># Fill the dataset with a fill value</span>
<span class="n">sds</span><span class="o">.</span><span class="n">setfillvalue</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Set dimension names</span>
<span class="n">dim1</span> <span class="o">=</span> <span class="n">sds</span><span class="o">.</span><span class="n">dim</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">dim1</span><span class="o">.</span><span class="n">setname</span><span class="p">(</span><span class="s2">&quot;row&quot;</span><span class="p">)</span>
<span class="n">dim2</span> <span class="o">=</span> <span class="n">sds</span><span class="o">.</span><span class="n">dim</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">dim2</span><span class="o">.</span><span class="n">setname</span><span class="p">(</span><span class="s2">&quot;col&quot;</span><span class="p">)</span>

<span class="c1"># Assign an attribute to the dataset</span>
<span class="n">sds</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="s2">&quot;W/m^2/micron/sr&quot;</span>

<span class="c1"># Write data</span>
<span class="n">sds</span><span class="p">[:,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">ch30_calibrated</span>

<span class="c1"># Close the dataset</span>
<span class="n">sds</span><span class="o">.</span><span class="n">endaccess</span><span class="p">()</span>

<span class="c1"># Flush and close the HDF file</span>
<span class="n">sd</span><span class="o">.</span><span class="n">end</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Did this work?  See if the file exists.  I’ll write it into the work folder in the home folder</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">work_dir</span> <span class="o">=</span> <span class="n">a301_lib</span><span class="o">.</span><span class="n">home_dir</span> <span class="o">/</span> <span class="s2">&quot;work&quot;</span>
<span class="n">hdf_files</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">work_dir</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">&quot;*hdf&quot;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">hdf_files</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[]
</pre></div>
</div>
</div>
</div>
</section>
<section id="move-all-of-this-into-a-function">
<span id="modis-level1b-function"></span><h2>move all of this into a function<a class="headerlink" href="#move-all-of-this-into-a-function" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">file_name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">all_files</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;reading </span><span class="si">{</span><span class="n">file_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">the_file</span> <span class="o">=</span> <span class="n">SD</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="n">SDC</span><span class="o">.</span><span class="n">READ</span><span class="p">)</span>
<span class="n">the_band</span><span class="o">=</span><span class="mi">30</span>

<span class="k">def</span> <span class="nf">readband</span><span class="p">(</span><span class="n">the_file</span><span class="p">,</span><span class="n">the_band</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    read and calibrate a MODIS band from an open hdf4 SD dataset</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    </span>
<span class="sd">       the_file:pyhdf.SD object</span>
<span class="sd">           the dataset open for reading</span>
<span class="sd">       the_band: int</span>
<span class="sd">           band number for MODIS (1-36)</span>
<span class="sd">           </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">       the_chan_calibrated: ndarray</span>
<span class="sd">           the pixel radiances in W/m^2/sr/micron</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">longwave_data</span> <span class="o">=</span> <span class="n">the_file</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;EV_1KM_Emissive&quot;</span><span class="p">)</span>  <span class="c1"># select sds</span>
    <span class="n">longwave_bands</span> <span class="o">=</span> <span class="n">the_file</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;Band_1KM_Emissive&quot;</span><span class="p">)</span>
    <span class="n">band_nums</span> <span class="o">=</span> <span class="n">longwave_bands</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
    <span class="n">thechan_index</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">searchsorted</span><span class="p">(</span><span class="n">band_nums</span><span class="p">,</span> <span class="n">the_band</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;channel index for band </span><span class="si">{</span><span class="n">the_band</span><span class="si">}</span><span class="s2"> is </span><span class="si">{</span><span class="n">thechan_index</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">thechan_data</span> <span class="o">=</span> <span class="n">longwave_data</span><span class="p">[</span><span class="n">thechan_index</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span>
    <span class="n">scales</span> <span class="o">=</span> <span class="n">longwave_data</span><span class="o">.</span><span class="n">attributes</span><span class="p">()[</span><span class="s2">&quot;radiance_scales&quot;</span><span class="p">]</span>
    <span class="n">offsets</span> <span class="o">=</span> <span class="n">longwave_data</span><span class="o">.</span><span class="n">attributes</span><span class="p">()[</span><span class="s2">&quot;radiance_offsets&quot;</span><span class="p">]</span>
    <span class="n">thechan_scale</span> <span class="o">=</span> <span class="n">scales</span><span class="p">[</span><span class="n">thechan_index</span><span class="p">]</span>
    <span class="n">thechan_offset</span> <span class="o">=</span> <span class="n">offsets</span><span class="p">[</span><span class="n">thechan_index</span><span class="p">]</span>
    <span class="n">thechan_calibrated</span> <span class="o">=</span> <span class="p">(</span><span class="n">thechan_data</span> <span class="o">-</span> <span class="n">thechan_offset</span><span class="p">)</span> <span class="o">*</span> <span class="n">thechan_scale</span>
    <span class="k">return</span> <span class="n">thechan_calibrated</span>

<span class="n">ch_radiance</span> <span class="o">=</span> <span class="n">readband</span><span class="p">(</span><span class="n">the_file</span><span class="p">,</span><span class="n">the_band</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">ch_radiance</span><span class="o">.</span><span class="n">flat</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5000</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;pixel count (unitless)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Radiance for band </span><span class="si">{</span><span class="n">the_band</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;radiance ($W\,m^{-2}\mu m^{-1}\,sr^{-1}$)&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>reading /home/phil/sat_data/pha/MYD021KM.A2013222.2105.061.2018047235850.hdf
channel index for band 30 is 9
</pre></div>
</div>
<img alt="../../_images/e42db525d7e09784d284b774c4f6adfa0d844b44e618fd841ea68d32e0de85a0.png" src="../../_images/e42db525d7e09784d284b774c4f6adfa0d844b44e618fd841ea68d32e0de85a0.png" />
</div>
</div>
</section>
<section id="close-the-file">
<h2>close the file<a class="headerlink" href="#close-the-file" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">the_file</span><span class="o">.</span><span class="n">end</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./notebooks/week1"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="satellite.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Acquiring satellite data</p>
      </div>
    </a>
    <a class="right-next"
       href="../week2/week2_topics.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Week 2</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#background">Background</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#get-all-files-from-the-data-dir-that-end-in-hdf">get all files from the data_dir that end in hdf</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#find-the-dataset-and-print-their-indices">Find the dataset and print their indices</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#open-one-of-the-datasets-number-4-ev-1km-emissive-and-get-its-shape-and-data-type">open one of the datasets (number 4, EV_1KM_Emissive) and get its shape and data type</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#get-the-first-row-of-the-first-channel-and-find-its-numpy-dtype">Get the first row of the first channel and find its numpy dtype</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#get-all-the-rows-and-columns-for-the-first-channel">get all the rows and columns for the first channel</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#find-the-attributes-for-ev-1km-emissive">Find the attributes for EV_1KM_Emissive</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#print-the-first-1000-characters-of-the-metadata-0-string">Print the first 1000 characters of the Metadata.0 string</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#now-plot-the-data-using-imshow">Now plot the data using imshow</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#find-the-index-for-channel-30">find the index for channel 30</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#now-get-the-data-for-channel-30">Now get the data for channel 30</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#now-convert-the-raw-counts-to-radiances">Now convert the raw counts to radiances</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-the-channel-30-radiances">Plot the Channel 30 radiances</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#write-the-radiances-out-for-safekeeping">Write the radiances out for safekeeping</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#move-all-of-this-into-a-function">move all of this into a function</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#close-the-file">close the file</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Philip Austin
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>